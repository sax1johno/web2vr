/*! For license information please see web2vr.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("aframe")):"function"==typeof define&&define.amd?define(["aframe"],e):"object"==typeof exports?exports.Web2VR=e(require("aframe")):t.Web2VR=e(t.aframe)}(self,(t=>(()=>{var e={611:(t,e,n)=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");n(458),n(862),n(776),n(313),n(758),n(227),n(819),n(680),AFRAME.registerComponent("super-hands",{schema:{colliderEvent:{default:"hit"},colliderEventProperty:{default:"el"},colliderEndEvent:{default:"hitend"},colliderEndEventProperty:{default:"el"},grabStartButtons:{default:["gripdown","trackpaddown","triggerdown","gripclose","abuttondown","bbuttondown","xbuttondown","ybuttondown","pointup","thumbup","pointingstart","pistolstart","thumbstickdown","mousedown","touchstart"]},grabEndButtons:{default:["gripup","trackpadup","triggerup","gripopen","abuttonup","bbuttonup","xbuttonup","ybuttonup","pointdown","thumbdown","pointingend","pistolend","thumbstickup","mouseup","touchend"]},stretchStartButtons:{default:["gripdown","trackpaddown","triggerdown","gripclose","abuttondown","bbuttondown","xbuttondown","ybuttondown","pointup","thumbup","pointingstart","pistolstart","thumbstickdown","mousedown","touchstart"]},stretchEndButtons:{default:["gripup","trackpadup","triggerup","gripopen","abuttonup","bbuttonup","xbuttonup","ybuttonup","pointdown","thumbdown","pointingend","pistolend","thumbstickup","mouseup","touchend"]},dragDropStartButtons:{default:["gripdown","trackpaddown","triggerdown","gripclose","abuttondown","bbuttondown","xbuttondown","ybuttondown","pointup","thumbup","pointingstart","pistolstart","thumbstickdown","mousedown","touchstart"]},dragDropEndButtons:{default:["gripup","trackpadup","triggerup","gripopen","abuttonup","bbuttonup","xbuttonup","ybuttonup","pointdown","thumbdown","pointingend","pistolend","thumbstickup","mouseup","touchend"]},interval:{default:0}},multiple:!1,init:function(){this.HOVER_EVENT="hover-start",this.UNHOVER_EVENT="hover-end",this.GRAB_EVENT="grab-start",this.UNGRAB_EVENT="grab-end",this.STRETCH_EVENT="stretch-start",this.UNSTRETCH_EVENT="stretch-end",this.DRAG_EVENT="drag-start",this.UNDRAG_EVENT="drag-end",this.DRAGOVER_EVENT="dragover-start",this.UNDRAGOVER_EVENT="dragover-end",this.DRAGDROP_EVENT="drag-drop",this.otherSuperHand=null,this.gehDragged=new Set,this.gehClicking=new Set,this.hoverEls=[],this.hoverElsIntersections=[],this.prevCheckTime=null,this.state=new Map,this.dragging=!1,this.unHover=this.unHover.bind(this),this.unWatch=this.unWatch.bind(this),this.onHit=this.onHit.bind(this),this.onGrabStartButton=this.onGrabStartButton.bind(this),this.onGrabEndButton=this.onGrabEndButton.bind(this),this.onStretchStartButton=this.onStretchStartButton.bind(this),this.onStretchEndButton=this.onStretchEndButton.bind(this),this.onDragDropStartButton=this.onDragDropStartButton.bind(this),this.onDragDropEndButton=this.onDragDropEndButton.bind(this),this.system.registerMe(this)},update:function(t){this.unRegisterListeners(t),this.registerListeners()},remove:function(){this.system.unregisterMe(this),this.unRegisterListeners(),this.hoverEls.length=0,this.state.get(this.HOVER_EVENT)&&this._unHover(this.state.get(this.HOVER_EVENT)),this.onGrabEndButton(),this.onStretchEndButton(),this.onDragDropEndButton()},tick:function(){function t(t,e){var n=null==t.distance?-1:t.distance,r=null==e.distance?-1:e.distance;return n<r?1:r<n?-1:0}return function(e){var n=this.data,r=this.prevCheckTime;if(!(r&&e-r<n.interval)){this.prevCheckTime=e;var i=!1;this.hoverElsIntersections.sort(t);for(var o=0;o<this.hoverElsIntersections.length;o++)this.hoverEls[o]!==this.hoverElsIntersections[o].object.el&&(i=!0,this.hoverEls[o]=this.hoverElsIntersections[o].object.el);i&&this.hover()}}}(),onGrabStartButton:function(t){var e=this.state.get(this.GRAB_EVENT);this.dispatchMouseEventAll("mousedown",this.el),this.gehClicking=new Set(this.hoverEls),e||(e=this.findTarget(this.GRAB_EVENT,{hand:this.el,buttonEvent:t}))&&(this.state.set(this.GRAB_EVENT,e),this._unHover(e))},onGrabEndButton:function(t){var e=this,n=this.hoverEls.filter((function(t){return e.gehClicking.has(t)})),r=this.state.get(this.GRAB_EVENT),i={hand:this.el,buttonEvent:t};this.dispatchMouseEventAll("mouseup",this.el);for(var o=0;o<n.length;o++)this.dispatchMouseEvent(n[o],"click",this.el);this.gehClicking.clear(),r&&!this.emitCancelable(r,this.UNGRAB_EVENT,i)&&(this.promoteHoveredEl(this.state.get(this.GRAB_EVENT)),this.state.delete(this.GRAB_EVENT),this.hover())},onStretchStartButton:function(t){var e=this.state.get(this.STRETCH_EVENT);e||(e=this.findTarget(this.STRETCH_EVENT,{hand:this.el,buttonEvent:t}))&&(this.state.set(this.STRETCH_EVENT,e),this._unHover(e))},onStretchEndButton:function(t){var e=this.state.get(this.STRETCH_EVENT),n={hand:this.el,buttonEvent:t};e&&!this.emitCancelable(e,this.UNSTRETCH_EVENT,n)&&(this.promoteHoveredEl(e),this.state.delete(this.STRETCH_EVENT),this.hover())},onDragDropStartButton:function(t){var e=this.state.get(this.DRAG_EVENT);this.dragging=!0,this.hoverEls.length&&(this.gehDragged=new Set(this.hoverEls),this.dispatchMouseEventAll("dragstart",this.el)),e||(e=this.state.get(this.GRAB_EVENT)&&!this.emitCancelable(this.state.get(this.GRAB_EVENT),this.DRAG_EVENT,{hand:this.el,buttonEvent:t})?this.state.get(this.GRAB_EVENT):this.findTarget(this.DRAG_EVENT,{hand:this.el,buttonEvent:t}))&&(this.state.set(this.DRAG_EVENT,e),this._unHover(e))},onDragDropEndButton:function(t){var e=this,n=this.state.get(this.DRAG_EVENT);if(this.dragging=!1,this.gehDragged.forEach((function(t){e.dispatchMouseEvent(t,"dragend",e.el),e.dispatchMouseEventAll("drop",t,!0,!0),e.dispatchMouseEventAll("dragleave",t,!0,!0)})),this.gehDragged.clear(),n){var r={hand:this.el,dropped:n,on:null,buttonEvent:t},i={hand:this.el,buttonEvent:t},o=this.findTarget(this.DRAGDROP_EVENT,r,!0);o&&(r.on=o,this.emitCancelable(n,this.DRAGDROP_EVENT,r),this._unHover(o)),this.emitCancelable(n,this.UNDRAG_EVENT,i)||(this.promoteHoveredEl(n),this.state.delete(this.DRAG_EVENT),this.hover())}},processHitEl:function(t,e){var n=this,r=e&&e.distance,i=this.hoverElsIntersections,o=this.hoverEls,a=!1;if(-1===this.hoverEls.indexOf(t)){if(a=!0,null!=r){for(var s=0;s<i.length&&r<i[s].distance;)s++;o.splice(s,0,t),i.splice(s,0,e)}else o.push(t),i.push({object:{el:t}});this.dispatchMouseEvent(t,"mouseover",this.el),this.dragging&&this.gehDragged.size&&this.gehDragged.forEach((function(t){n.dispatchMouseEventAll("dragenter",t,!0,!0)}))}return a},onHit:function(t){var e=t.detail[this.data.colliderEventProperty],n=0;if(e){if(Array.isArray(e))for(var r,i=0;i<e.length;i++)r=t.detail.intersections&&t.detail.intersections[i],n+=this.processHitEl(e[i],r);else n+=this.processHitEl(e,null);n&&this.hover()}},hover:function(){var t,e;this.state.has(this.HOVER_EVENT)&&this._unHover(this.state.get(this.HOVER_EVENT),!0),this.state.has(this.DRAGOVER_EVENT)&&this._unHover(this.state.get(this.DRAGOVER_EVENT),!0),this.dragging&&this.state.get(this.DRAG_EVENT)&&(t={hand:this.el,hovered:e,carried:this.state.get(this.DRAG_EVENT)},(e=this.findTarget(this.DRAGOVER_EVENT,t,!0))&&(this.emitCancelable(this.state.get(this.DRAG_EVENT),this.DRAGOVER_EVENT,t),this.state.set(this.DRAGOVER_EVENT,e))),this.state.has(this.DRAGOVER_EVENT)||(e=this.findTarget(this.HOVER_EVENT,{hand:this.el},!0))&&this.state.set(this.HOVER_EVENT,e)},unHover:function(t){var e=this,n=t.detail[this.data.colliderEndEventProperty];n&&(Array.isArray(n)?n.forEach((function(t){return e._unHover(t)})):this._unHover(n))},_unHover:function(t,e){var n,r=!1;t===this.state.get(this.DRAGOVER_EVENT)&&(this.state.delete(this.DRAGOVER_EVENT),r=!0,n={hand:this.el,hovered:t,carried:this.state.get(this.DRAG_EVENT)},this.emitCancelable(t,this.UNDRAGOVER_EVENT,n),this.state.has(this.DRAG_EVENT)&&this.emitCancelable(this.state.get(this.DRAG_EVENT),this.UNDRAGOVER_EVENT,n)),t===this.state.get(this.HOVER_EVENT)&&(this.state.delete(this.HOVER_EVENT),r=!0,this.emitCancelable(t,this.UNHOVER_EVENT,{hand:this.el})),r&&!e&&this.hover()},unWatch:function(t){var e=this,n=t.detail[this.data.colliderEndEventProperty];n&&(Array.isArray(n)?n.forEach((function(t){return e._unWatch(t)})):this._unWatch(n))},_unWatch:function(t){var e=this,n=this.hoverEls.indexOf(t);-1!==n&&(this.hoverEls.splice(n,1),this.hoverElsIntersections.splice(n,1)),this.gehDragged.forEach((function(n){e.dispatchMouseEvent(t,"dragleave",n),e.dispatchMouseEvent(n,"dragleave",t)})),this.dispatchMouseEvent(t,"mouseout",this.el)},registerListeners:function(){var t=this;this.el.addEventListener(this.data.colliderEvent,this.onHit),this.el.addEventListener(this.data.colliderEndEvent,this.unWatch),this.el.addEventListener(this.data.colliderEndEvent,this.unHover),this.data.grabStartButtons.forEach((function(e){t.el.addEventListener(e,t.onGrabStartButton)})),this.data.stretchStartButtons.forEach((function(e){t.el.addEventListener(e,t.onStretchStartButton)})),this.data.dragDropStartButtons.forEach((function(e){t.el.addEventListener(e,t.onDragDropStartButton)})),this.data.dragDropEndButtons.forEach((function(e){t.el.addEventListener(e,t.onDragDropEndButton)})),this.data.stretchEndButtons.forEach((function(e){t.el.addEventListener(e,t.onStretchEndButton)})),this.data.grabEndButtons.forEach((function(e){t.el.addEventListener(e,t.onGrabEndButton)}))},unRegisterListeners:function(t){var e=this;t=t||this.data,0!==Object.keys(t).length&&(this.el.removeEventListener(t.colliderEvent,this.onHit),this.el.removeEventListener(t.colliderEndEvent,this.unHover),this.el.removeEventListener(t.colliderEndEvent,this.unWatch),t.grabStartButtons.forEach((function(t){e.el.removeEventListener(t,e.onGrabStartButton)})),t.grabEndButtons.forEach((function(t){e.el.removeEventListener(t,e.onGrabEndButton)})),t.stretchStartButtons.forEach((function(t){e.el.removeEventListener(t,e.onStretchStartButton)})),t.stretchEndButtons.forEach((function(t){e.el.removeEventListener(t,e.onStretchEndButton)})),t.dragDropStartButtons.forEach((function(t){e.el.removeEventListener(t,e.onDragDropStartButton)})),t.dragDropEndButtons.forEach((function(t){e.el.removeEventListener(t,e.onDragDropEndButton)})))},emitCancelable:function(t,e,n){var r={bubbles:!0,cancelable:!0,detail:n=n||{}};r.detail.target=r.detail.target||t;var i=new window.CustomEvent(e,r);return t.dispatchEvent(i)},dispatchMouseEvent:function(t,e,n){var r=new window.MouseEvent(e,{relatedTarget:n});t.dispatchEvent(r)},dispatchMouseEventAll:function(t,e,n,r){var i=this,o=this.hoverEls;if(n&&(o=o.filter((function(t){return t!==i.state.get(i.GRAB_EVENT)&&t!==i.state.get(i.DRAG_EVENT)&&t!==i.state.get(i.STRETCH_EVENT)&&!i.gehDragged.has(t)}))),r)for(var a=0;a<o.length;a++)this.dispatchMouseEvent(o[a],t,e),this.dispatchMouseEvent(e,t,o[a]);else for(var s=0;s<o.length;s++)this.dispatchMouseEvent(o[s],t,e)},findTarget:function(t,e,n){var r,i=this,o=this.hoverEls;for(n&&(o=o.filter((function(t){return t!==i.state.get(i.GRAB_EVENT)&&t!==i.state.get(i.DRAG_EVENT)&&t!==i.state.get(i.STRETCH_EVENT)}))),r=o.length-1;r>=0;r--)if(!this.emitCancelable(o[r],t,e))return o[r];return null},promoteHoveredEl:function(t){var e=this.hoverEls.indexOf(t);if(-1!==e&&null==this.hoverElsIntersections[e].distance){this.hoverEls.splice(e,1);var n=this.hoverElsIntersections.splice(e,1);this.hoverEls.push(t),this.hoverElsIntersections.push(n[0])}}})},680:(t,e,n)=>{var r=n(624);AFRAME.registerComponent("clickable",AFRAME.utils.extendDeep({},r,{schema:{onclick:{type:"string"}},init:function(){this.CLICKED_STATE="clicked",this.CLICK_EVENT="grab-start",this.UNCLICK_EVENT="grab-end",this.clickers=[],this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.CLICK_EVENT,this.start),this.el.addEventListener(this.UNCLICK_EVENT,this.end)},remove:function(){this.el.removeEventListener(this.CLICK_EVENT,this.start),this.el.removeEventListener(this.UNCLICK_EVENT,this.end)},start:function(t){!t.defaultPrevented&&this.startButtonOk(t)&&(this.el.addState(this.CLICKED_STATE),-1===this.clickers.indexOf(t.detail.hand)&&(this.clickers.push(t.detail.hand),t.preventDefault&&t.preventDefault()))},end:function(t){var e=this.clickers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&this.clickers.splice(e,1),this.clickers.length<1&&this.el.removeState(this.CLICKED_STATE),t.preventDefault&&t.preventDefault())}}))},758:(t,e,n)=>{var r=AFRAME.utils.extendDeep,i=n(624);AFRAME.registerComponent("drag-droppable",r({},i,{init:function(){console.warn("Warning: drag-droppable is deprecated. Use draggable and droppable components instead"),this.HOVERED_STATE="dragover",this.DRAGGED_STATE="dragged",this.HOVER_EVENT="dragover-start",this.UNHOVER_EVENT="dragover-end",this.DRAG_EVENT="drag-start",this.UNDRAG_EVENT="drag-end",this.DRAGDROP_EVENT="drag-drop",this.hoverStart=this.hoverStart.bind(this),this.dragStart=this.dragStart.bind(this),this.hoverEnd=this.hoverEnd.bind(this),this.dragEnd=this.dragEnd.bind(this),this.dragDrop=this.dragDrop.bind(this),this.el.addEventListener(this.HOVER_EVENT,this.hoverStart),this.el.addEventListener(this.DRAG_EVENT,this.dragStart),this.el.addEventListener(this.UNHOVER_EVENT,this.hoverEnd),this.el.addEventListener(this.UNDRAG_EVENT,this.dragEnd),this.el.addEventListener(this.DRAGDROP_EVENT,this.dragDrop)},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.hoverStart),this.el.removeEventListener(this.DRAG_EVENT,this.dragStart),this.el.removeEventListener(this.UNHOVER_EVENT,this.hoverEnd),this.el.removeEventListener(this.UNDRAG_EVENT,this.dragEnd),this.el.removeEventListener(this.DRAGDROP_EVENT,this.dragDrop)},hoverStart:function(t){this.el.addState(this.HOVERED_STATE),t.preventDefault&&t.preventDefault()},dragStart:function(t){this.startButtonOk(t)&&(this.el.addState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},hoverEnd:function(t){this.el.removeState(this.HOVERED_STATE)},dragEnd:function(t){this.endButtonOk(t)&&(this.el.removeState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},dragDrop:function(t){this.endButtonOk(t)&&t.preventDefault&&t.preventDefault()}}))},227:(t,e,n)=>{var r=AFRAME.utils.extendDeep,i=n(624);AFRAME.registerComponent("draggable",r({},i,{init:function(){this.DRAGGED_STATE="dragged",this.DRAG_EVENT="drag-start",this.UNDRAG_EVENT="drag-end",this.dragStartBound=this.dragStart.bind(this),this.dragEndBound=this.dragEnd.bind(this),this.el.addEventListener(this.DRAG_EVENT,this.dragStartBound),this.el.addEventListener(this.UNDRAG_EVENT,this.dragEndBound)},remove:function(){this.el.removeEventListener(this.DRAG_EVENT,this.dragStart),this.el.removeEventListener(this.UNDRAG_EVENT,this.dragEnd)},dragStart:function(t){!t.defaultPrevented&&this.startButtonOk(t)&&(this.el.addState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},dragEnd:function(t){!t.defaultPrevented&&this.endButtonOk(t)&&(this.el.removeState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())}}))},819:()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}AFRAME.registerComponent("droppable",{schema:{accepts:{default:""},autoUpdate:{default:!0},acceptEvent:{default:""},rejectEvent:{default:""}},multiple:!0,init:function(){this.HOVERED_STATE="dragover",this.HOVER_EVENT="dragover-start",this.UNHOVER_EVENT="dragover-end",this.DRAGDROP_EVENT="drag-drop",this.hoverStartBound=this.hoverStart.bind(this),this.hoverEndBound=this.hoverEnd.bind(this),this.dragDropBound=this.dragDrop.bind(this),this.mutateAcceptsBound=this.mutateAccepts.bind(this),this.acceptableEntities=[],this.observer=new window.MutationObserver(this.mutateAcceptsBound),this.observerOpts={childList:!0,subtree:!0},this.el.addEventListener(this.HOVER_EVENT,this.hoverStartBound),this.el.addEventListener(this.UNHOVER_EVENT,this.hoverEndBound),this.el.addEventListener(this.DRAGDROP_EVENT,this.dragDropBound)},update:function(){this.data.accepts.length?this.acceptableEntities=Array.prototype.slice.call(this.el.sceneEl.querySelectorAll(this.data.accepts)):this.acceptableEntities=null,this.data.autoUpdate&&null!=this.acceptableEntities?this.observer.observe(this.el.sceneEl,this.observerOpts):this.observer.disconnect()},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.hoverStartBound),this.el.removeEventListener(this.UNHOVER_EVENT,this.hoverEndBound),this.el.removeEventListener(this.DRAGDROP_EVENT,this.dragDropBound),this.observer.disconnect()},mutateAccepts:function(t){var e=this,n=this.data.accepts;t.forEach((function(t){t.addedNodes.forEach((function(t){var r,i;i=n,((r=t).matches?r.matches(i):r.msMatchesSelector?r.msMatchesSelector(i):r.webkitMatchesSelector?r.webkitMatchesSelector(i):void 0)&&e.acceptableEntities.push(t)}))}))},entityAcceptable:function(e){var n=this.acceptableEntities;if(null==n)return!0;var r,i=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}(n);try{for(i.s();!(r=i.n()).done;)if(r.value===e)return!0}catch(t){i.e(t)}finally{i.f()}return!1},hoverStart:function(t){!t.defaultPrevented&&this.entityAcceptable(t.detail.carried)&&(this.el.addState(this.HOVERED_STATE),t.preventDefault&&t.preventDefault())},hoverEnd:function(t){t.defaultPrevented||this.el.removeState(this.HOVERED_STATE)},dragDrop:function(t){if(!t.defaultPrevented){var e=t.detail.dropped;this.entityAcceptable(e)?(this.data.acceptEvent.length&&this.el.emit(this.data.acceptEvent,{el:e}),t.preventDefault&&t.preventDefault()):this.data.rejectEvent.length&&this.el.emit(this.data.rejectEvent,{el:e})}}})},776:(t,e,n)=>{var r,i,o,a,s=AFRAME.utils.extendDeep,l=s({},n(17),n(624));AFRAME.registerComponent("sh-grabbable",s(l,{schema:{maxGrabbers:{type:"int",default:NaN},invert:{default:!1},suppressY:{default:!1}},init:function(){var t=this;this.GRABBED_STATE="grabbed",this.GRAB_EVENT="grab-start",this.UNGRAB_EVENT="grab-end",this.grabbed=!1,this.grabbers=[],this.constraints=new Map,this.deltaPositionIsValid=!1,this.grabDistance=void 0,this.grabDirection={x:0,y:0,z:-1},this.grabOffset={x:0,y:0,z:0},this.destPosition={x:0,y:0,z:0},this.deltaPosition=new THREE.Vector3,this.targetPosition=new THREE.Vector3,this.physicsInit(),this.el.addEventListener(this.GRAB_EVENT,(function(e){return t.start(e)})),this.el.addEventListener(this.UNGRAB_EVENT,(function(e){return t.end(e)})),this.el.addEventListener("mouseout",(function(e){return t.lostGrabber(e)}))},update:function(){this.physicsUpdate(),this.xFactor=this.data.invert?-1:1,this.zFactor=this.data.invert?-1:1,this.yFactor=(this.data.invert?-1:1)*!this.data.suppressY},tick:(o=new THREE.Quaternion,a=new THREE.Vector3,function(){var t;this.grabber&&(this.targetPosition.copy(this.grabDirection),this.targetPosition.applyQuaternion(this.grabber.object3D.getWorldQuaternion(o)).setLength(this.grabDistance).add(this.grabber.object3D.getWorldPosition(a)).add(this.grabOffset),this.deltaPositionIsValid?(this.deltaPosition.sub(this.targetPosition),t=this.el.getAttribute("position"),this.destPosition.x=t.x-this.deltaPosition.x*this.xFactor,this.destPosition.y=t.y-this.deltaPosition.y*this.yFactor,this.destPosition.z=t.z-this.deltaPosition.z*this.zFactor,this.el.setAttribute("position",this.destPosition)):this.deltaPositionIsValid=!0,this.deltaPosition.copy(this.targetPosition))}),remove:function(){this.el.removeEventListener(this.GRAB_EVENT,this.start),this.el.removeEventListener(this.UNGRAB_EVENT,this.end),this.physicsRemove()},start:function(t){if(!t.defaultPrevented&&this.startButtonOk(t)){var e=!Number.isFinite(this.data.maxGrabbers)||this.grabbers.length<this.data.maxGrabbers;if(-1===this.grabbers.indexOf(t.detail.hand)&&e){if(!t.detail.hand.object3D)return void console.warn("sh-grabbable entities must have an object3D");this.grabbers.push(t.detail.hand),this.physicsStart(t)||this.grabber||(this.grabber=t.detail.hand,this.resetGrabber()),t.preventDefault&&t.preventDefault(),this.grabbed=!0,this.el.addState(this.GRABBED_STATE)}}},end:function(t){var e=this.grabbers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&(this.grabbers.splice(e,1),this.grabber=this.grabbers[0]),this.physicsEnd(t),this.resetGrabber()||(this.grabbed=!1,this.el.removeState(this.GRABBED_STATE)),t.preventDefault&&t.preventDefault())},resetGrabber:(r=new THREE.Vector3,i=new THREE.Vector3,function(){if(!this.grabber)return!1;var t=this.grabber.getAttribute("raycaster");return this.deltaPositionIsValid=!1,this.grabDistance=this.el.object3D.getWorldPosition(r).distanceTo(this.grabber.object3D.getWorldPosition(i)),t&&(this.grabDirection=t.direction,this.grabOffset=t.origin),!0}),lostGrabber:function(t){var e=this.grabbers.indexOf(t.relatedTarget);-1===e||t.relatedTarget===this.grabber||this.physicsIsConstrained(t.relatedTarget)||this.grabbers.splice(e,1)}}))},862:()=>{AFRAME.registerComponent("hoverable",{init:function(){this.HOVERED_STATE="hovered",this.HOVER_EVENT="hover-start",this.UNHOVER_EVENT="hover-end",this.hoverers=[],this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.HOVER_EVENT,this.start),this.el.addEventListener(this.UNHOVER_EVENT,this.end)},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.start),this.el.removeEventListener(this.UNHOVER_EVENT,this.end)},start:function(t){t.defaultPrevented||(this.el.addState(this.HOVERED_STATE),-1===this.hoverers.indexOf(t.detail.hand)&&this.hoverers.push(t.detail.hand),t.preventDefault&&t.preventDefault())},end:function(t){if(!t.defaultPrevented){var e=this.hoverers.indexOf(t.detail.hand);-1!==e&&this.hoverers.splice(e,1),this.hoverers.length<1&&this.el.removeState(this.HOVERED_STATE)}}})},624:t=>{t.exports=function(){function t(t,e){return 0===e.length||-1!==e.indexOf(t.detail.buttonEvent.type)}return{schema:{startButtons:{default:[]},endButtons:{default:[]}},startButtonOk:function(e){return t(e,this.data.startButtons)},endButtonOk:function(e){return t(e,this.data.endButtons)}}}()},17:t=>{function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.exports={schema:{usePhysics:{default:"ifavailable"}},physicsInit:function(){this.constraints=new Map},physicsUpdate:function(){"never"===this.data.usePhysics&&this.constraints.size&&this.physicsClear()},physicsRemove:function(){this.physicsClear()},physicsStart:function(t){if("never"!==this.data.usePhysics&&this.el.body&&t.detail.hand.body&&!this.constraints.has(t.detail.hand)){var e=Math.random().toString(36).substr(2,9);return this.el.setAttribute("constraint__"+e,{target:t.detail.hand}),this.constraints.set(t.detail.hand,e),!0}return"only"===this.data.usePhysics},physicsEnd:function(t){var e=this.constraints.get(t.detail.hand);e&&(this.el.removeAttribute("constraint__"+e),this.constraints.delete(t.detail.hand))},physicsClear:function(){if(this.el.body){var t,n=function(t,n){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}(this.constraints.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.el.body.world.removeConstraint(r)}}catch(t){n.e(t)}finally{n.f()}}this.constraints.clear()},physicsIsConstrained:function(t){return this.constraints.has(t)},physicsIsGrabbing:function(){return this.constraints.size>0}}},313:(t,e,n)=>{function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=AFRAME.utils.extendDeep,o=i({},n(624));AFRAME.registerComponent("stretchable",i(o,{schema:{usePhysics:{default:"ifavailable"},invert:{default:!1},physicsUpdateRate:{default:100}},init:function(){this.STRETCHED_STATE="stretched",this.STRETCH_EVENT="stretch-start",this.UNSTRETCH_EVENT="stretch-end",this.stretched=!1,this.stretchers=[],this.scale=new THREE.Vector3,this.handPos=new THREE.Vector3,this.otherHandPos=new THREE.Vector3,this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.STRETCH_EVENT,this.start),this.el.addEventListener(this.UNSTRETCH_EVENT,this.end)},update:function(t){this.updateBodies=AFRAME.utils.throttleTick(this._updateBodies,this.data.physicsUpdateRate,this)},tick:function(t,e){if(this.stretched){this.scale.copy(this.el.getAttribute("scale")),this.stretchers[0].object3D.getWorldPosition(this.handPos),this.stretchers[1].object3D.getWorldPosition(this.otherHandPos);var n=this.handPos.distanceTo(this.otherHandPos),r=1;null!==this.previousStretch&&0!==n&&(r=Math.pow(n/this.previousStretch,this.data.invert?-1:1)),this.previousStretch=n,null==this.previousPhysicsStretch&&(this.previousPhysicsStretch=n),this.scale.multiplyScalar(r),this.el.setAttribute("scale",this.scale),this.updateBodies(t,e)}},remove:function(){this.el.removeEventListener(this.STRETCH_EVENT,this.start),this.el.removeEventListener(this.UNSTRETCH_EVENT,this.end)},start:function(t){this.stretched||this.stretchers.includes(t.detail.hand)||!this.startButtonOk(t)||t.defaultPrevented||(this.stretchers.push(t.detail.hand),2===this.stretchers.length&&(this.stretched=!0,this.previousStretch=null,this.previousPhysicsStretch=null,this.el.addState(this.STRETCHED_STATE)),t.preventDefault&&t.preventDefault())},end:function(t){var e=this.stretchers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&(this.stretchers.splice(e,1),this.stretched=!1,this.el.removeState(this.STRETCHED_STATE),this._updateBodies()),t.preventDefault&&t.preventDefault())},_updateBodies:function(){if(this.el.body&&"never"!==this.data.usePhysics){var t=this.previousStretch,e=1;if(null!==this.previousPhysicsStretch&&t>0&&(e=Math.pow(t/this.previousPhysicsStretch,this.data.invert?-1:1)),this.previousPhysicsStretch=t,1!==e){var n,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}(this.el.childNodes);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.stretchBody(o,e)}}catch(t){i.e(t)}finally{i.f()}this.stretchBody(this.el,e)}}},stretchBody:function(t,e){if(t.body){for(var n,r,i=0;i<t.body.shapes.length;i++)(n=t.body.shapes[i]).halfExtents?(n.halfExtents.scale(e,n.halfExtents),n.updateConvexPolyhedronRepresentation()):n.radius?(n.radius*=e,n.updateBoundingSphereRadius()):this.shapeWarned||(console.warn("Unable to stretch physics body: unsupported shape"),this.shapeWarned=!0),(r=t.body.shapeOffsets[i]).scale(e,r);t.body.updateBoundingRadius()}}}))},458:()=>{AFRAME.registerSystem("super-hands",{init:function(){this.superHands=[]},registerMe:function(t){1===this.superHands.length&&(this.superHands[0].otherSuperHand=t,t.otherSuperHand=this.superHands[0]),this.superHands.push(t)},unregisterMe:function(t){var e=this.superHands.indexOf(t);-1!==e&&this.superHands.splice(e,1),this.superHands.forEach((function(e){e.otherSuperHand===t&&(e.otherSuperHand=null)}))}})},600:()=>{AFRAME.registerComponent("vr-animate",{init:function(){var t,e,n,r;this.running=!1,null===(t=this.el.element)||void 0===t||t.domElement.addEventListener("animationstart",this.startAnimation.bind(this)),null===(e=this.el.element)||void 0===e||e.domElement.addEventListener("animationend",this.stopAnimation.bind(this)),null===(n=this.el.element)||void 0===n||n.domElement.addEventListener("transitionstart",this.startAnimation.bind(this)),null===(r=this.el.element)||void 0===r||r.domElement.addEventListener("transitionend",this.stopAnimation.bind(this))},tick:function(){var t;this.running&&(null===(t=this.el.element)||void 0===t||t.web2vr.update())},startAnimation:function(){this.running=!0},stopAnimation:function(){var t;this.running=!1,null===(t=this.el.element)||void 0===t||t.web2vr.update()}})},725:()=>{AFRAME.registerComponent("vr-border",{schema:{width:{type:"number"},color:{type:"string"}},init:function(){this.running=!0;var t=this.el.object3D.children[0],e=new THREE.EdgesGeometry(t.geometry),n=new THREE.LineSegments(e,new THREE.LineBasicMaterial({color:0,linewidth:this.data.width}));this.borderObject=n,this.el.element.web2vr.aframe.container.object3D.add(this.borderObject),this.el.element.clippingContext&&(n.material.clippingPlanes=this.el.element.clippingContext.planes,n.material.needsUpdate=!0)},update:function(){var t=this.data.width;this.el.element.borderWidth?this.borderObject.material.linewidth=this.el.element.borderWidth:this.borderObject.material.linewidth=t,this.el.element.borderColor?this.borderObject.material.color=this.el.element.borderColor:this.borderObject.material.color=new THREE.Color(this.data.color)},updateBorder:function(){var t;null!==(t=this.el.element)&&void 0!==t&&t.visible?(this.running=!0,this.borderObject.material.visible=!0):this.borderObject.material.visible=!1},tick:function(){if(this.running){var t=this.el.object3D.scale,e=this.el.object3D.children[0].geometry.clone();e.scale(t.x,t.y,t.z);var n=new THREE.EdgesGeometry(e),r=this.el.object3D.position;this.borderObject.geometry=n,this.borderObject.position.set(r.x,r.y,r.z+2*this.el.element.web2vr.settings.layerStep),this.running=!1}},remove:function(){this.el.element.web2vr.aframe.container.object3D.remove(this.borderObject)}})},395:()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}AFRAME.registerComponent("vr-grab-rotate-static",{tick:function(){if(this.el.components["sh-grabbable"].grabbed){if(this.el.web2vr.scroll.hasScroll){var e,n=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}(this.el.web2vr.elements);try{for(n.s();!(e=n.n()).done;)e.value.updateClipping()}catch(t){n.e(t)}finally{n.f()}}var r=this.el.object3D,i=this.el.components["sh-grabbable"].grabbers[0].object3D;r.rotation.y=Math.atan2(i.position.x-(r.position.x+this.el.children[0].getAttribute("width")/2),i.position.z-r.position.z)}}})},720:()=>{AFRAME.registerComponent("vr-renderer",{init:function(){this.el.sceneEl.renderer.localClippingEnabled=!0}})},965:()=>{function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}AFRAME.registerComponent("vr-scrollbar",{init:function(){this.el.addEventListener("click",function(n){var r=parseFloat(this.el.web2vr.aframe.container.firstElementChild.element.style.height)-this.el.web2vr.settings.scrollWindowHeight;this.el.web2vr.scroll.scrollContainer==this.el.web2vr.container&&(r=this.el.web2vr.scroll.scrollContainer.scrollHeight-this.el.web2vr.scroll.scrollContainer.clientHeight);var i,o=(1-n.detail.intersection.uv.y)*r/this.el.web2vr.settings.scale,a=function(t){if(Array.isArray(t))return e(t)}(i=this.el.web2vr.elements)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||t(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();a.shift(),this.el.pointer.object3D.position.setY(this.pointEndY+n.detail.intersection.uv.y*(this.pointStartY-this.pointEndY));var s,l=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=t(e))){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}(a);try{for(l.s();!(s=l.n()).done;)s.value.position.scrollY=o}catch(t){l.e(t)}finally{l.f()}this.el.web2vr.update()}.bind(this))},play:function(){var t=parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute("width")),e=parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute("height"));this.el.setAttribute("width",t/20),this.el.setAttribute("height",e),this.el.scrollbar.object3D.position.setX(t+parseFloat(this.el.getAttribute("width")/2)),this.el.scrollbar.object3D.position.setY(0-e/2),this.el.scrollbar.object3D.position.setZ(-4*this.el.web2vr.settings.layerStep),this.el.pointer.setAttribute("height",t/20),this.el.pointer.setAttribute("width",t/20),this.pointStartY=e/2-parseFloat(this.el.pointer.getAttribute("height"))/2,this.pointEndY=this.pointStartY-e+parseFloat(this.el.pointer.getAttribute("height")),this.el.pointer.object3D.position.setY(this.pointStartY),this.el.pointer.object3D.position.setZ(2*this.el.web2vr.settings.layerStep)}})},305:()=>{function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){var n,o,a;n=t,o=e,a=i[e],(o=r(o))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),n(3);var r=n(4),i={mode:"normal"};i.template=new r,t.exports=window.AFK=i},function(t,e,r){var i=r(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("a-keyboard",{schema:{audio:{default:!1},color:{default:"#fff"},highlightColor:{default:"#1a79dc"},dismissable:{default:!0},font:{default:"monoid"},fontSize:{default:"0.39"},locale:{default:"en"},model:{default:""},baseTexture:{default:""},keyTexture:{default:""},verticalAlign:{default:"center"}},init:function(){AFK.template.draw(n(n({},this.data),{},{el:this.el})),this.attachEventListeners()},attachEventListeners:function(){window.addEventListener("keydown",this.handleKeyboardPress),this.el.addEventListener("click",this.handleKeyboardVR)},removeEventListeners:function(){window.removeEventListener("keydown",this.handleKeyboardPress),this.el.removeEventListener("click",this.handleKeyboardVR)},handleKeyboardPress:function(t){i(t)},handleKeyboardVR:function(t){i(t,"vr")},remove:function(){this.removeEventListeners()}})},function(t,e){t.exports=function(t,e){var n,r=new Set([16,17,18,20,33,34,35,36,45,46,112,113,114,115,116,117,118,119,120,121,122,123]),i=t.key&&t.key.charCodeAt(0),o=t.key,a=t.keyCode;if("vr"===e)a=parseInt(document.querySelector("#".concat(t.target.id)).getAttribute("key-code")),o=document.querySelector("#".concat(t.target.id)).getAttribute("value");else if(r.has(t.keyCode))return;switch(a){case 9:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:"\t"}}),document.dispatchEvent(n);break;case 8:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:""}}),document.dispatchEvent(n);break;case 13:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:"\n"}}),document.dispatchEvent(n);break;case 16:AFK.template.toggleActiveMode("shift");break;case 18:AFK.template.toggleActiveMode("alt");break;case 27:this.dismissable&&(n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:""}}),document.dispatchEvent(n));break;case 32:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:" "}}),document.dispatchEvent(n);break;default:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:o}}),document.dispatchEvent(n)}if("vr"!==e){var s=document.querySelector("#a-keyboard-".concat(i))||document.querySelector("#a-keyboard-".concat(t.keyCode));s&&(s.dispatchEvent(new Event("mousedown")),setTimeout((function(){s.dispatchEvent(new Event("mouseleave"))}),80))}}},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("keyboard-button",{init:function(){var t=this,e=this.el;e.addEventListener("mousedown",(function(){e.setAttribute("material","opacity","0.7")})),e.addEventListener("mouseup",(function(){e.setAttribute("material","opacity",t.isMouseEnter?"0.9":"0")})),e.addEventListener("mouseenter",(function(){e.setAttribute("material","opacity","0.9"),self.isMouseEnter=!0})),e.addEventListener("mouseleave",(function(){e.setAttribute("material","opacity","0"),self.isMouseEnter=!1}))}})},function(e,n,r){var i=r(5);e.exports=function(){return e=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keyboardKeys={},this.activeMode="normal"},n=[{key:"draw",value:function(t){for(var e in t)this[e]=t[e];this.keyboardKeys=i(t.locale),this.drawKeyboard()}},{key:"drawButton",value:function(t){var e=t.key,n=e.size.split(" ")[0],r=e.size.split(" ")[1],i=document.createElement("a-entity");i.setAttribute("position",t.position);var o=document.createElement("a-entity");o.setAttribute("geometry","primitive: plane; width: ".concat(n,"; height: ").concat(r,";")),this.keyTexture&&this.keyTexture.length>0?o.setAttribute("material","src: ".concat(this.keyTexture)):o.setAttribute("material","color: #4a4a4a; opacity: 0.9");var a=document.createElement("a-text");a.id="a-keyboard-".concat(e.code),a.setAttribute("key-code",e.code),a.setAttribute("value",e.value),a.setAttribute("align","center"),a.setAttribute("baseline",this.verticalAlign),a.setAttribute("position","0 0 0.001"),a.setAttribute("width",this.fontSize),a.setAttribute("height",this.fontSize),a.setAttribute("geometry","primitive: plane; width: ".concat(n,"; height: ").concat(r)),a.setAttribute("material","opacity: 0.0; transparent: true; color: ".concat(this.highlightColor)),a.setAttribute("color",this.color),a.setAttribute("font",this.font),a.setAttribute("shader","msdf"),a.setAttribute("negate","false"),a.setAttribute("keyboard-button",!0),a.setAttribute("class","collidable"),i.appendChild(o),i.appendChild(a),this.el.appendChild(i)}},{key:"drawKeyboard",value:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);if(this.keyboardKeys){var t=this.keyboardKeys[this.activeMode]||this.keyboardKeys.normal,e=document.createElement("a-entity"),n=.04*t.length+.004*(t.length-1)+.04;e.setAttribute("position","".concat(.26-.02," ").concat(-n/2+.02," -0.01")),e.setAttribute("geometry","primitive: plane; width: ".concat(.52,"; height: ").concat(n)),this.baseTexture&&this.baseTexture.length>0?e.setAttribute("material","src: ".concat(this.baseTexture)):e.setAttribute("material","color: #4a4a4a; side: double; opacity: 0.7"),this.el.appendChild(e);for(var r=0,i=0;i<t.length;i++)for(var o=t[i],a=0,s=0;s<o.length;s++){var l=o[s],u=this.parseKeyObjects(l);if(this.dismissable||"cancel"!==l.type){var c=u.size.split(" ")[0],h=u.size.split(" ")[1];this.drawButton({key:u,position:"".concat(a+c/2," ").concat(r-h/2," 0")}),a+=parseFloat(c)+.004,o.length===s+1&&(r-=.044)}}}}},{key:"toggleActiveMode",value:function(t){t===this.activeMode?(this.activeMode="normal",this.drawKeyboard()):(this.activeMode=t,this.drawKeyboard())}},{key:"parseKeyObjects",value:function(t){var e=t.type,n=t.value;switch(e){case"delete":return{size:"0.04 0.04 0",value:n,code:"8"};case"enter":return{size:"0.04 0.084 0",value:n,code:"13"};case"shift":return{size:"0.084 0.04 0",value:n,code:"16"};case"alt":return{size:"0.084 0.04 0",value:n,code:"18"};case"space":return{size:"".concat(.2+.016," 0.04 0"),value:n,code:"32"};case"cancel":return{size:"0.084 0.04 0",value:n,code:"24"};case"submit":return{size:"0.084 0.04 0",value:n,code:"06"};default:return{size:"0.04 0.04 0",value:n,code:n.charCodeAt(0)}}}}],n&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}()},function(t,e,n){var r=n(6);t.exports=function(t){return r}},function(t,e){t.exports={name:"ms-US-International",normal:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"q",type:"standard"},{value:"w",type:"standard"},{value:"e",type:"standard"},{value:"r",type:"standard"},{value:"t",type:"standard"},{value:"y",type:"standard"},{value:"u",type:"standard"},{value:"i",type:"standard"},{value:"o",type:"standard"},{value:"p",type:"standard"},{value:"Ent",type:"enter"}],[{value:"a",type:"standard"},{value:"s",type:"standard"},{value:"d",type:"standard"},{value:"f",type:"standard"},{value:"g",type:"standard"},{value:"h",type:"standard"},{value:"j",type:"standard"},{value:"k",type:"standard"},{value:"l",type:"standard"},{value:'"',type:"standard"}],[{value:"Shift",type:"shift"},{value:"z",type:"standard"},{value:"x",type:"standard"},{value:"c",type:"standard"},{value:"v",type:"standard"},{value:"b",type:"standard"},{value:"n",type:"standard"},{value:"m",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]],shift:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"Q",type:"standard"},{value:"W",type:"standard"},{value:"E",type:"standard"},{value:"R",type:"standard"},{value:"T",type:"standard"},{value:"Y",type:"standard"},{value:"U",type:"standard"},{value:"I",type:"standard"},{value:"O",type:"standard"},{value:"P",type:"standard"},{value:"Ent",type:"enter"}],[{value:"A",type:"standard"},{value:"S",type:"standard"},{value:"D",type:"standard"},{value:"F",type:"standard"},{value:"G",type:"standard"},{value:"H",type:"standard"},{value:"J",type:"standard"},{value:"K",type:"standard"},{value:"L",type:"standard"},{value:'"',type:"standard"}],[{value:"Shift",type:"shift"},{value:"Z",type:"standard"},{value:"X",type:"standard"},{value:"C",type:"standard"},{value:"V",type:"standard"},{value:"B",type:"standard"},{value:"N",type:"standard"},{value:"M",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]],alt:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"~",type:"standard"},{value:"`",type:"standard"},{value:"|",type:"standard"},{value:"(",type:"standard"},{value:")",type:"standard"},{value:"^",type:"standard"},{value:"_",type:"standard"},{value:"-",type:"standard"},{value:"=",type:"standard"},{value:"!",type:"standard"},{value:"Ent",type:"enter"}],[{value:"@",type:"standard"},{value:"#",type:"standard"},{value:"$",type:"standard"},{value:"%",type:"standard"},{value:"*",type:"standard"},{value:"[",type:"standard"},{value:"]",type:"standard"},{value:"#",type:"standard"},{value:"<",type:"standard"},{value:"?",type:"standard"}],[{value:"Shift",type:"shift"},{value:":",type:"standard"},{value:";",type:"standard"},{value:"{",type:"standard"},{value:"}",type:"standard"},{value:"/",type:"standard"},{value:"\\",type:"standard"},{value:">",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]]}}])},54:()=>{[Element].forEach((function(t){t.prototype._addEventListener=t.prototype.addEventListener,t.prototype.addEventListener=function(t,e,n){this.eventListenerList||(this.eventListenerList={}),n=void 0!==n&&n;var r=this;if(r._addEventListener(t,e,n),r.eventListenerList[t]||(r.eventListenerList[t]=[]),r.eventListenerList[t].push({type:t,handle:e,useCapture:n,remove:function(){return r.removeEventListener(this.type,this.handle,this.useCapture),r.eventListenerList[t]}}),"eventListenerAdded"!=t&&"eventListenerRemoved"!=t){var i=new CustomEvent("eventListenerAdded",{detail:{type:t,handle:e,useCapture:n}});this.dispatchEvent(i)}},t.prototype._removeEventListener=t.prototype.removeEventListener,t.prototype.removeEventListener=function(t,e,n){this.eventListenerList||(this.eventListenerList={});var r=this;if(r.eventListenerList[t]&&(r._removeEventListener(t,e,n),r.eventListenerList[t]=r.eventListenerList[t].filter((function(t){return t&&t.handle&&e&&t.handle.toString()!==e.toString()})),0===r.eventListenerList[t].length&&delete r.eventListenerList[t],"eventListenerAdded"!=t&&"eventListenerRemoved"!=t)){var i=new CustomEvent("eventListenerRemoved",{detail:{type:t,handle:e,useCapture:n}});this.dispatchEvent(i)}}}))},156:t=>{"use strict";var e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===n}(t)}(t)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?s((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function i(t,e,n){return t.concat(e).map((function(t){return r(t,n)}))}function o(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return Object.propertyIsEnumerable.call(t,e)})):[]}(t))}function a(t,e){try{return e in t}catch(t){return!1}}function s(t,n,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||e,l.cloneUnlessOtherwiseSpecified=r;var u=Array.isArray(n);return u===Array.isArray(t)?u?l.arrayMerge(t,n,l):function(t,e,n){var i={};return n.isMergeableObject(t)&&o(t).forEach((function(e){i[e]=r(t[e],n)})),o(e).forEach((function(o){(function(t,e){return a(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,o)||(a(t,o)&&n.isMergeableObject(e[o])?i[o]=function(t,e){if(!e.customMerge)return s;var n=e.customMerge(t);return"function"==typeof n?n:s}(o,n)(t[o],e[o],n):i[o]=r(e[o],n))})),i}(t,n,l):r(n,l)}s.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return s(t,n,e)}),{})};var l=s;t.exports=l},668:e=>{"use strict";e.exports=t}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i={};return(()=>{"use strict";r.d(i,{default:()=>Ae}),r(54);var t=r(156),e=r.n(t);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}r(668),r(305),r(611);var l=a((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scale=600,this.position={x:0,y:2,z:-1},this.rotation={x:0,y:0,z:0},this.layerStep=5e-4,this.parentSelector=null,this.interactiveTag="vr-interactable",this.ignoreTags=["BR","SOURCE","SCRIPT","AUDIO","NOSCRIPT"],this.debug=!1,this.showClipping=!1,this.forceClipping=!1,this.experimental=!1,this.scroll=!0,this.scrollWindowHeight=800,this.createControllers=!0,this.raycasterFar=5,this.skybox=!0,this.border=!0}));function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}r(725),r(600),r(395),r(965);var d=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.web2vr=e,this.hasScroll=!1,this.scrollBody=!1,this.scrollContainer=null,this.web2vr.settings.scroll&&(this.checkScrollbar(),this.hasScroll&&this.createScrollbar())},(e=[{key:"checkScrollbar",value:function(){var t=document.scrollingElement,e=this.web2vr.container;t.scrollHeight>t.clientHeight?(this.hasScroll=!0,this.scrollContainer=t,this.scrollBody=!0):"scroll"==e.element.style.overflow&&(this.hasScroll=!0,this.scrollContainer=e)}},{key:"createScrollbar",value:function(){this.scrollbar=document.createElement("a-entity"),this.pointer=document.createElement("a-plane"),this.pointer.setAttribute("material","shader","flat"),this.pointer.setAttribute("color","#C1C1C1"),this.plane=document.createElement("a-plane"),this.plane.setAttribute("material","shader","flat"),this.plane.setAttribute("material","side","double"),this.plane.classList.add(this.web2vr.settings.interactiveTag),this.plane.setAttribute("color","#F1F1F1"),this.plane.setAttribute("width",1),this.plane.setAttribute("vr-scrollbar",""),this.plane.web2vr=this.web2vr,this.plane.pointer=this.pointer,this.plane.scrollbar=this.scrollbar,this.plane.appendChild(this.pointer),this.scrollbar.appendChild(this.plane),this.web2vr.aframe.container.appendChild(this.scrollbar)}},{key:"update",value:function(){this.hasScroll&&("visible"==this.web2vr.container.element.style.visibility?(this.scrollbar.object3D.visible=!0,this.plane.classList.add(this.web2vr.settings.interactiveTag)):"hidden"==this.web2vr.container.element.style.visibility&&(this.scrollbar.object3D.visible=!1,this.plane.classList.remove(this.web2vr.settings.interactiveTag)))}}])&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function y(t){var e=function(t,e){if("object"!=f(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}var b=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=document.getElementsByTagName("a-assets")[0];n?this.assets=n:(this.assets=document.createElement("a-assets"),e.appendChild(this.assets))},(e=[{key:"updateCurrentAssetId",value:function(){var t=parseInt(this.assets.getAttribute("current-id"));this.assets.getAttribute("current-id")||(this.assets.setAttribute("current-id",0),t=0),this.assets.setAttribute("current-id",t+1)}},{key:"updateCurrentAssetIdReturn",value:function(){return this.updateCurrentAssetId(),"asset-"+this.assets.getAttribute("current-id")}},{key:"getAsset",value:function(t,e){var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.assets.getChildren());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.getAttribute("src")===t)return i.getAttribute("id")}}catch(t){r.e(t)}finally{r.f()}return this.createAsset(t,e)}},{key:"createAsset",value:function(t,e){var n=document.createElement(e);n.setAttribute("src",t),this.updateCurrentAssetId();var r="asset-"+this.assets.getAttribute("current-id");return n.setAttribute("id",r),n.setAttribute("crossorigin","Anonymous"),this.assets.appendChild(n),r}},{key:"removeAsset",value:function(t){this.assets.querySelector("#"+t).remove()}}])&&v(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,g(r.key),r)}}function g(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:e+""}r(720);var w=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inVR=!1,this.settings=e,this.createScene(),this.assetManager=new b(this.scene)},(e=[{key:"createScene",value:function(){var t=this,e=document.getElementsByTagName("a-scene");e.length>0?this.scene=e[0]:(this.scene=document.createElement("a-scene"),document.body.appendChild(this.scene),this.newScene=!0),this.settings.debug&&this.scene.setAttribute("stats",""),this.scene.setAttribute("vr-renderer",""),this.scene.addEventListener("enter-vr",function(){t.inVR=!0}.bind(this)),this.scene.addEventListener("exit-vr",function(){t.inVR=!1}.bind(this))}},{key:"createContainer",value:function(t){this.container=document.createElement("a-entity"),this.container.classList.add("vr-container"),this.container.classList.add(this.settings.interactiveTag);var e=parseFloat(window.getComputedStyle(t.container).width)*(1/this.settings.scale),n=this.settings.position.x;0==n&&(n-=e/2),this.container.object3D.position.set(n,this.settings.position.y,this.settings.position.z),this.container.setAttribute("rotation",{x:this.settings.rotation.x,y:this.settings.rotation.y,z:this.settings.rotation.z});var r=document.querySelector(this.settings.parentSelector);r?r.appendChild(this.container):(this.container.setAttribute("vr-grab-rotate-static",""),this.container.setAttribute("sh-grabbable",""),this.container.setAttribute("stretchable",""),this.scene.appendChild(this.container)),this.container.web2vr=t}},{key:"createSky",value:function(){0==document.getElementsByTagName("a-sky").length&&this.settings.skybox&&(this.sky=document.createElement("a-sky"),this.sky.setAttribute("color","#a9f8fe"),this.scene.appendChild(this.sky))}},{key:"createControllers",value:function(){var t=this;if(!document.getElementById("mouseCursor")){var e=document.createElement("a-entity");e.id="mouseCursor",e.setAttribute("cursor","rayOrigin","mouse"),e.setAttribute("raycaster","objects: .".concat(this.settings.interactiveTag,", .collidable")),this.scene.appendChild(e)}if(this.settings.createControllers&&!document.getElementById("leftHand")){var n="objects: .".concat(this.settings.interactiveTag,", .collidable; far: ").concat(this.settings.raycasterFar),r="colliderEvent: raycaster-intersection; colliderEventProperty: els; colliderEndEvent:raycaster-intersection-cleared; colliderEndEventProperty: clearedEls; grabStartButtons: gripdown; grabEndButtons: gripup; stretchStartButtons: gripdown; stretchEndButtons: gripup",i=document.createElement("a-entity");i.id="leftHand",i.setAttribute("hand-controls","hand:left; handModelStyle: highPoly; color: #ffcccc"),i.setAttribute("laser-controls",""),i.setAttribute("raycaster",n),i.setAttribute("super-hands",r);var o=document.createElement("a-entity");o.id="rightHand",o.setAttribute("hand-controls","hand:right; handModelStyle: highPoly; color: #ffcccc"),o.setAttribute("laser-controls",""),o.setAttribute("raycaster",n),o.setAttribute("super-hands",r),this.scene.appendChild(i),this.scene.appendChild(o)}this.keyboard=document.getElementById("vr-keyboard"),this.keyboard||(this.keyboard=document.createElement("a-entity"),this.keyboard.id="vr-keyboard",this.keyboard.setAttribute("a-keyboard",""),this.keyboard.setAttribute("sh-grabbable",""),this.scene.appendChild(this.keyboard),this.keyboard.object3D.visible=!1,this.keyboard.activeInput=null,document.addEventListener("a-keyboard-update",(function(e){if(t.keyboard.activeInput){var n=parseInt(e.detail.code),r=t.keyboard.activeInput.value;if(8==n)r=r.slice(0,-1);else{if(6==n||24==n)return t.keyboard.object3D.visible=!1,t.keyboard.object3D.position.y=1e4,t.keyboard.activeInput.element.active=!1,t.keyboard.activeInput.element.update(),void(t.keyboard.activeInput=null);[37,38,39,40].includes(n)||(r+=e.detail.value)}t.keyboard.activeInput.value=r,t.keyboard.activeInput.element.update()}})))}}])&&E(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,T(r.key),r)}}function T(t){var e=function(t,e){if("object"!=S(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}var O=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.depth=n,this.startDepth=n,this.scale=r,this.scrollY=0,this.updatePosition(e)},(e=[{key:"updatePosition",value:function(t){this.domPosition=t,this.aframePosition=this.calculateAFramePosition(this.domPosition)}},{key:"calculateAFramePosition",value:function(t){var e={x:t.x+t.width/2,y:t.y+t.height/2,z:this.depth};return e.x*=this.scalingFactor,e.y*=-1*this.scalingFactor,e.width=t.width*this.scalingFactor,e.height=t.height*this.scalingFactor,e}},{key:"equalsDOMPosition",value:function(t){return this.domPosition.top==t.top&&this.domPosition.bottom==t.bottom&&this.domPosition.left==t.left&&this.domPosition.right==t.right}},{key:"scalingFactor",get:function(){return 1/this.scale}},{key:"x",get:function(){return this.aframePosition.x}},{key:"y",get:function(){return this.aframePosition.y+this.scrollY}},{key:"z",get:function(){return this.aframePosition.z}},{key:"width",get:function(){return this.aframePosition.width}},{key:"height",get:function(){return this.aframePosition.height}},{key:"xyz",get:function(){return{x:this.x,y:this.y,z:this.z}}},{key:"left",get:function(){return{x:this.x-this.width/2,y:this.y,z:this.z}}},{key:"right",get:function(){return{x:this.x+this.width/2,y:this.y,z:this.z}}},{key:"top",get:function(){return{x:this.x,y:this.y+this.height/2,z:this.z}}},{key:"bottom",get:function(){return{x:this.x,y:this.y-this.height/2,z:this.z}}}])&&A(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function R(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}var _=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.listeningForMouseEvents=!1,this.resync(),this.checkEntityEvents()},(e=[{key:"resync",value:function(){for(var t=["click","mouseenter","mouseleave","mousedown","mouseup"],e=!1,n=0,r=t;n<r.length;n++){var i=r[n];if(this.element.domElement.eventListenerList&&this.element.domElement.eventListenerList[i]){e=!0;break}}for(var o=!1,a=0,s=["onclick","onmouseenter","onmouseleave","onmousedown","onmouseup"];a<s.length;a++){var l=s[a];if(this.element.domElement[l]){o=!0;break}}e||o?this.listeningForMouseEvents||(this.addMouseListeners(t),this.listeningForMouseEvents=!0):this.listeningForMouseEvents&&(this.removeMouseListeners(t),this.listeningForMouseEvents=!1)}},{key:"mouseEventHandler",value:function(t){var e=new MouseEvent(t.type,{view:window,bubbles:!0,cancelable:!0,target:this.element.domElement});this.element.domElement.dispatchEvent(e)}},{key:"addMouseListeners",value:function(t){var e=this;t.forEach((function(t){e.element.entity.addEventListener(t,e.mouseEventHandler.bind(e))}))}},{key:"removeMouseListeners",value:function(t){var e=this;t.forEach((function(t){e.element.entity.removeEventListener(t,e.mouseEventHandler.bind(e))}))}},{key:"checkEntityEvents",value:function(){for(var t=0,e=["click","mouseenter","mouseleave","mousedown","mouseup"];t<e.length;t++){var n=e[t];if(this.element.entity.eventListenerList&&this.element.entity.eventListenerList[n]){this.listeningForMouseEvents=!0;break}}}}])&&j(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function k(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function L(t){var e=function(t,e){if("object"!=C(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}var N=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.web2vr=e,this.domElement=n,this.layer=r,this.domElement.element=this,this.childElements=new Set,this.entity=null,this.visible=!0,this.domElement.classList.contains("vr-span")&&this.paddingToMargin(),this.position=new O(this.domElement.getBoundingClientRect(),r*this.web2vr.settings.layerStep,e.settings.scale),this.style=window.getComputedStyle(this.domElement),this.parentTransform="none",this.needsStartingTransformSize=!0,this.initComplete=!1},(e=[{key:"initEventHandlers",value:function(){var t=this;this.initHover(),this.mouseEventHandle=new _(this),this.domElement.addEventListener("eventListenerAdded",(function(){return t.mouseEventHandle.resync()})),this.domElement.addEventListener("eventListenerRemoved",(function(){return t.mouseEventHandle.resync()}))}},{key:"checkAnimation",value:function(){parseFloat(this.style.animationDuration)||parseFloat(this.style.transitionDuration)?this.entity.setAttribute("vr-animate",""):this.entity.removeAttribute("vr-animate")}},{key:"initHover",value:function(){var t=this,e=null;this.web2vr.hoverSelectors.has(this.domElement.tagName.toLowerCase())&&(e=this.domElement.tagName.toLowerCase());var n,r=[],i=k(this.domElement.classList);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.web2vr.hoverSelectors.has("."+o)&&r.push(o)}}catch(t){i.e(t)}finally{i.f()}var a=null;this.web2vr.hoverSelectors.has("#"+this.domElement.id)&&(a=this.domElement.id),(e||r.length>0||a)&&(this.entity.addEventListener("mouseenter",(function(){if(e&&t.domElement.classList.add(e+"hover"),r.length>0){var n,i=k(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.domElement.classList.add(o+"hover")}}catch(t){i.e(t)}finally{i.f()}}a&&t.domElement.classList.add(a+"hover"),"none"!=t.style.transform&&(t.web2vr.update(),t.hoverTransform=!0)})),this.entity.addEventListener("mouseleave",(function(){if(e&&t.domElement.classList.remove(e+"hover"),r.length>0){var n,i=k(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.domElement.classList.remove(o+"hover")}}catch(t){i.e(t)}finally{i.f()}}if(a&&t.domElement.classList.remove(a+"hover"),t.hoverTransform){t.position.depth=t.position.startDepth;var s,l=k(t.domElement.querySelectorAll("*"));try{for(l.s();!(s=l.n()).done;){var u=s.value;u.element&&(u.element.parentTransform="none",u.element.position.depth=u.element.position.startDepth)}}catch(t){l.e(t)}finally{l.f()}}})))}},{key:"paddingToMargin",value:function(){if(this.domElement.textContent.trim()){var t=this.domElement.parentElement.element.style.paddingRight;parseFloat(t)&&(this.domElement.style.marginRight=t,this.domElement.parentElement.style.paddingRight="0px")}}},{key:"init",value:function(){this.entity.element=this,this.entity.setAttribute("material","shader","flat"),this.entity.setAttribute("width",this.position.width),this.entity.setAttribute("height",this.position.height),this.initEventHandlers(),this.setupClipping(),this.finalizeInit()}},{key:"finalizeInit",value:function(){this.initComplete=!0,this.domElement.dispatchEvent(new Event("initComplete"))}},{key:"update",value:function(){var t,e,n=this;if(this.initComplete){var r=this.domElement.getBoundingClientRect();if(0==r.width||0==r.height)return this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag),void(this.position.aframePosition.y=1e3);if(this.domElement.classList.contains("vr-span")&&(this.entity.classList.remove(this.web2vr.settings.interactiveTag),"BUTTON"!=this.domElement.parentElement.tagName&&(r.width+=8,r.x-=2)),null!==(t=this.web2vr.scroll)&&void 0!==t&&t.hasScroll&&this.domElement==this.web2vr.container&&null!==(e=this.web2vr.scroll)&&void 0!==e&&e.scrollBody&&(r.height=this.web2vr.settings.scrollWindowHeight),this.position.updatePosition(r),this.checkVisible(),this.visible){if(this.style=window.getComputedStyle(this.domElement),"hidden"===this.style.visibility||"none"===this.style.display)return this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag),this.position.aframePosition.y=1e3,void this.updateBorder();this.entity.object3D.visible=!0,(!this.domElement.classList.contains("vr-span")&&(this.mouseEventHandle.listeningForMouseEvents||"INPUT"==this.domElement.tagName&&"text"==this.domElement.type)||this.domElement==this.web2vr.container)&&this.entity.classList.add(this.web2vr.settings.interactiveTag),("none"==this.style.transform||this.needsStartingTransformSize)&&(this.entity.setAttribute("width",this.position.width),this.entity.setAttribute("height",this.position.height)),this.checkAnimation();var i=this.style.opacity;this.entity.setAttribute("opacity",i),this.specificUpdate(),this.updateTransform(),this.updateClipping()}this.updateBorder()}else this.domElement.addEventListener(new Event("initComplete"),(function(){return n.update()}))}},{key:"updateTransform",value:function(){var t=this.style.transform;if("none"==t)t=this.parentTransform;else{var e,n=k(this.domElement.querySelectorAll("*"));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.element&&(r.element.parentTransform=t)}}catch(t){n.e(t)}finally{n.f()}}if("none"!=t){this.needsStartingTransformSize=!1;var i=t.split("(")[0],o=t.split("(")[1];o=(o=(o=o.split(")")[0]).split(",")).map((function(t){return parseFloat(t)}));var a=null;"matrix"==i?a=(new THREE.Matrix4).fromArray([o[0],o[1],0,0,-o[2],o[3],0,0,0,0,1,0,o[4],o[5],0,1]):"matrix3d"==i&&(o[4]*=-1,o[9]*=-1,a=(new THREE.Matrix4).fromArray(o));var s=new THREE.Vector3,l=new THREE.Quaternion,u=new THREE.Vector3;if(a.decompose(s,l,u),this.position.domPosition.x+=s.x,this.position.domPosition.y+=s.y,0!=s.z&&(this.position.depth=s.z*this.position.scalingFactor+this.position.startDepth),this.entity.object3D.rotation.setFromRotationMatrix(a),"none"==this.parentTransform){var c=a.elements,h=Math.sqrt(c[0]*c[0]+c[1]*c[1]),d=Math.sqrt(c[5]*c[5]+c[4]*c[4]);"INPUT"!=this.domElement.tagName||"radio"!=this.domElement.type&&"checkbox"!=this.domElement.type?this.entity.object3D.scale.set(h,d,1):this.entity.object3D.scale.set(h/2,d/2,1)}}this.entity.object3D.position.set(this.position.x,this.position.y,this.position.z)}},{key:"specificUpdate",value:function(){}},{key:"updateBorder",value:function(){if(this.web2vr.settings.border){var t=parseFloat(this.style.borderTopWidth);(t||this.borderWidth)&&this.entity.object3D.visible?(this.entity.setAttribute("vr-border","width:".concat(t,"; color:").concat(this.style.borderTopColor,";")),this.entity.components["vr-border"].updateBorder()):this.entity.components["vr-border"]&&this.entity.removeAttribute("vr-border")}}},{key:"rotateNormal",value:function(t){var e=(new THREE.Matrix3).getNormalMatrix(this.web2vr.aframe.container.object3D.matrixWorld);return t.clone().applyMatrix3(e).normalize()}},{key:"getClippingContext",value:function(){var t,e=null;if(this.domElement.parentNode&&this.domElement.parentNode.element&&this.domElement.parentNode.element.clippingContext)e=this.domElement.parentNode.element.clippingContext;else if((this.style.overflow&&"hidden"==this.style.overflow||null!==(t=this.web2vr.scroll)&&void 0!==t&&t.hasScroll&&this.domElement==this.web2vr.container||this.web2vr.settings.forceClipping&&this.domElement==this.web2vr.container)&&"svg"!=this.domElement.tagName){var n={};n.authority=this,n.bottom=new THREE.Plane(this.rotateNormal(new THREE.Vector3(0,1,0))),n.top=new THREE.Plane(this.rotateNormal(new THREE.Vector3(0,-1,0))),n.left=new THREE.Plane(this.rotateNormal(new THREE.Vector3(1,0,0))),n.right=new THREE.Plane(this.rotateNormal(new THREE.Vector3(-1,0,0))),n.planes=[n.bottom,n.top,n.left,n.right],e=n}return e}},{key:"setupClipping",value:function(){var t=this,e=this.getClippingContext();if(e){this.clippingContext=e;var n=this.entity.object3D;if(!n||!n.children||!n.children.length>0||!n.children[0].material)return;n.children[0].material.clippingPlanes=e.planes,setTimeout((function(){t.updateClipping()}),200)}}},{key:"updateClipping",value:function(){if(this.clippingContext&&this.clippingContext.authority==this){var t=this.entity.object3D.position,e=t.clone().add(new THREE.Vector3(0,-1,0).multiplyScalar(this.position.height/2)),n=t.clone().add(new THREE.Vector3(0,1,0).multiplyScalar(this.position.height/2)),r=t.clone().add(new THREE.Vector3(-1,0,0).multiplyScalar(this.position.width/2)),i=t.clone().add(new THREE.Vector3(1,0,0).multiplyScalar(this.position.width/2)),o=this.web2vr.aframe.container.object3D.localToWorld(e.clone()),a=this.web2vr.aframe.container.object3D.localToWorld(n.clone()),s=this.web2vr.aframe.container.object3D.localToWorld(r.clone()),l=this.web2vr.aframe.container.object3D.localToWorld(i.clone());if(this.clippingContext.bottom.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0,1,0)),o).normalize(),this.clippingContext.top.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0,-1,0)),a).normalize(),this.clippingContext.left.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(1,0,0)),s).normalize(),this.clippingContext.right.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(-1,0,0)),l).normalize(),this.web2vr.settings.showClipping){if(!this.clippingPlaneHelpers){this.clippingPlaneHelpers=[];var u,c=k(this.clippingContext.planes);try{for(c.s();!(u=c.n()).done;){var h=u.value,d=new THREE.MeshBasicMaterial({color:58173,side:THREE.DoubleSide}),f=new THREE.PlaneGeometry(200*this.position.scalingFactor,200*this.position.scalingFactor),p=new THREE.Mesh(f,d);p.debugPlane=h,this.clippingPlaneHelpers.push(p);var v=new THREE.AxesHelper(5);p.add(v)}}catch(t){c.e(t)}finally{c.f()}var y,b=k(this.clippingPlaneHelpers);try{for(b.s();!(y=b.n()).done;){var m=y.value;this.web2vr.aframe.scene.object3D.add(m)}}catch(t){b.e(t)}finally{b.f()}}var E,g=k(this.clippingPlaneHelpers);try{for(g.s();!(E=g.n()).done;){var w=E.value;w.visible=!0;var S=new THREE.Vector3;this.entity.object3D.getWorldPosition(S);var A=new THREE.Vector3;w.debugPlane.projectPoint(S,A),w.position.set(A.x,A.y,A.z);var T=A.clone().add(w.debugPlane.normal.clone().multiplyScalar(-1));w.lookAt(T)}}catch(t){g.e(t)}finally{g.f()}}else if(this.clippingPlaneHelpers){var O,P=k(this.clippingPlaneHelpers);try{for(P.s();!(O=P.n()).done;)O.value.visible=!1}catch(t){P.e(t)}finally{P.f()}}}}},{key:"checkVisible",value:function(){if(this.clippingContext){var t=this.clippingContext.authority;this.position.bottom.y>t.position.top.y||this.position.top.y<t.position.bottom.y?(this.visible=!1,this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag)):(this.visible=!0,this.entity.object3D.visible=!0,(!this.domElement.classList.contains("vr-span")&&this.mouseEventHandle.listeningForMouseEvents||this.domElement==this.web2vr.container)&&this.entity.classList.add(this.web2vr.settings.interactiveTag))}}}])&&x(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function B(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==V(e)?e:e+""}var M=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"isUrl",value:function(t){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)}},{key:"clamp",value:function(t,e,n){return Math.min(n,Math.max(e,t))}}],null&&H(t.prototype,null),e&&H(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function F(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==I(e)?e:e+""}function U(t,e,n){return e=W(e),function(t,e){if(e&&("object"===I(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,z()?Reflect.construct(e,n||[],W(t).constructor):e.apply(t,n))}function z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(z=function(){return!!t})()}function W(t){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},W(t)}function K(t,e){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},K(t,e)}var q=function(t){function e(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=U(this,e,[t,n,r])).textOnly=o,i.entity=document.createElement("a-plane"),"A"==i.domElement.tagName&&i.entity.addEventListener("click",(function(){console.log("Link clicked!",i.domElement.click())})),i.textOnly||(i.domElement==i.web2vr.container&&i.entity.setAttribute("material","side","double"),i.expImageId=null,i.oldBackgroundImage=null,i.oldDomPosition=null),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K(t,e)}(e,t),n=e,(r=[{key:"specificUpdate",value:function(){var t=this;if(!this.textOnly){var e=this.style.backgroundColor,n=this.style.backgroundImage;if("none"!=n)if(this.web2vr.settings.experimental){if(n!=this.oldBackgroundImage||this.oldDomPosition&&!this.position.equalsDOMPosition(this.oldDomPosition)){var r=this.domElement.id,i=!1;r||(i=!0,r="html2canvas-"+this.web2vr.html2canvasIDcounter++,this.domElement.id=r),html2canvas(this.domElement,{onclone:function(e){var n=document.createElement("style");e.head.appendChild(n),n.sheet.insertRule("\n                    #".concat(r," {\n                        opacity: 1;\n                    }")),n.sheet.insertRule("\n                    #".concat(r," {\n                        color: transparent;\n                    }")),n.sheet.insertRule("\n                    #".concat(r," > * {\n                        display:none\n                    }")),n.sheet.insertRule("\n                    #".concat(r," > .vr-span {\n                        display:block\n                    }")),i&&t.domElement.removeAttribute("id")}}).then((function(e){t.expImageId&&t.web2vr.aframe.assetManager.removeAsset(t.expImageId),t.expImageId=t.web2vr.aframe.assetManager.getAsset(e.toDataURL(),"img"),t.entity.setAttribute("material","src: #"+t.expImageId)})),this.oldBackgroundImage=n}}else M.isUrl(n)&&(n=n.substring(n.lastIndexOf('("')+2,n.lastIndexOf('")')),this.entity.setAttribute("material","src: #"+this.web2vr.aframe.assetManager.getAsset(n,"img")),this.entity.setAttribute("material","transparent",!0));else"rgba(0, 0, 0, 0)"==e?this.entity.setAttribute("material","visible",!1):(this.entity.setAttribute("material","visible",!0),this.entity.setAttribute("color",e),this.updateOpacity());this.oldDomPosition=this.position.domPosition}}},{key:"updateOpacity",value:function(){var t=parseFloat(this.style.backgroundColor.split(",")[3]);if(t){var e=t,n=this.style.opacity;e<n&&(n=t,e=this.style.opacity),this.entity.setAttribute("opacity",e-(e-n))}}}])&&G(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}function Q(t,e,n){return e=tt(e),function(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Z()?Reflect.construct(e,n||[],tt(t).constructor):e.apply(t,n))}function Z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Z=function(){return!!t})()}function J(){return J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},J.apply(this,arguments)}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}function et(t,e){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},et(t,e)}var nt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Q(this,e,[t,n,r,!1])).entity.setAttribute("text","value",""),i.textValue=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&et(t,e)}(e,t),n=e,(r=[{key:"setupClipping",value:function(){var t=this.getClippingContext();if(t){this.clippingContext=t;var e=this.entity.components.text.material;e.fragmentShader="#version 300 es\n            precision highp float;\n            uniform bool negate;\n            uniform float alphaTest;\n            uniform float opacity;\n            uniform sampler2D map;\n            uniform vec3 color;\n            in vec2 vUV;\n            out vec4 fragColor;\n            float median(float r, float g, float b) {\n                return max(min(r, g), min(max(r, g), b));\n            }\n            #define BIG_ENOUGH 0.001\n            #define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\n            \n            // clipping_planes_pars_fragment converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n                in vec3 vClipPosition;\n                uniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n            #endif\n            \n            void main() {\n                // compatible with glsl 3\n                #include <clipping_planes_fragment>\n\n                vec3 sampleColor = texture(map, vUV).rgb;\n                if (negate) { sampleColor = 1.0 - sampleColor; }\n                float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n                float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n                float dscale = 0.353505;\n                vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));\n                float isBigEnough = max(abs(duv.x), abs(duv.y));\n                // Do modified alpha test.\n                if (isBigEnough > BIG_ENOUGH) {\n                    float ratio = BIG_ENOUGH / isBigEnough;\n                    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n                }\n                // Do modified alpha test.\n                if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n                fragColor = vec4(color.xyz, alpha * opacity);\n            }",e.vertexShader="#version 300 es\n            in vec2 uv;\n            in vec3 position;\n            uniform mat4 projectionMatrix;\n            uniform mat4 modelViewMatrix;\n            out vec2 vUV;\n\n            // clipping_planes_pars_vertex converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n\t            out vec3 vClipPosition;\n            #endif\n\n            void main(void) {\n                // compatible with glsl 3\n                #include <begin_vertex>\n\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                vUV = uv;\n\n                // compatible with glsl 3\n                #include <project_vertex>\n                #include <clipping_planes_vertex>\n\n            }",e.clipping=!0,e.clippingPlanes=t.planes,this.updateClipping()}}},{key:"updateTextAlignment",value:function(){var t=this.style.textAlign;["left","right","center"].includes(t)||(t="left"),this.entity.setAttribute("text","align",t);var e=this.entity.components.text;"normal"!=this.style.lineHeight&&void 0!==e.currentFont&&this.entity.setAttribute("text","lineHeight",e.currentFont.common.lineHeight+parseFloat(this.style.lineHeight))}},{key:"updateTextSize",value:function(){var t=parseFloat(this.style.fontSize),e=this.position.width,n=e/this.position.scalingFactor*42/t;n*=1.107,this.entity.setAttribute("text","wrapPixels",n),this.entity.setAttribute("text","width",e)}},{key:"updateTextColor",value:function(){var t=this.domElement.parentElement.element.style.opacity;this.entity.setAttribute("text","opacity",t);var e=this.style.color;this.entity.setAttribute("text","color",e)}},{key:"updateText",value:function(){this.textValue=this.domElement.textContent.replace(/\s{2,}/g," ")}},{key:"specificUpdate",value:function(){J(tt(e.prototype),"specificUpdate",this).call(this),this.updateTextSize(),this.updateTextAlignment(),this.updateText(),this.entity.setAttribute("text","value",this.textValue),this.updateTextColor()}}])&&$(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(q);function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ot(r.key),r)}}function ot(t){var e=function(t,e){if("object"!=rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:e+""}function at(t,e,n){return e=lt(e),function(t,e){if(e&&("object"===rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,st()?Reflect.construct(e,n||[],lt(t).constructor):e.apply(t,n))}function st(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(st=function(){return!!t})()}function lt(t){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lt(t)}function ut(t,e){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ut(t,e)}var ct=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=at(this,e,[t,n,r])).currentSrc=null,i.changed=!1,i.entity=document.createElement("a-image"),i.entity.setAttribute("material","side","front"),i.loaded=!1,i.domElement.addEventListener("load",(function(){i.loaded=!0,i.changed&&(i.changed=!1,i.web2vr.update())})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ut(t,e)}(e,t),n=e,(r=[{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.entity.setAttribute("id","IMAGE_"+e),/\.(gif)$/i.test(t)?(this.entity.setAttribute("material","shader","gif"),this.entity.setAttribute("material","src","#"+e)):(this.entity.setAttribute("material","shader","flat"),this.entity.setAttribute("src","#"+e))}},{key:"specificUpdate",value:function(){var t=this.domElement.getAttribute("src");t!=this.currentSrc&&(this.currentSrc&&(this.loaded=!1,this.changed=!0),this.currentSrc=t,this.updateImage(this.currentSrc))}}])&&it(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ft(r.key),r)}}function ft(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}function pt(t,e,n){return e=yt(e),function(t,e){if(e&&("object"===ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vt()?Reflect.construct(e,n||[],yt(t).constructor):e.apply(t,n))}function vt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(vt=function(){return!!t})()}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}function bt(t,e){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bt(t,e)}var mt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=pt(this,e,[t,n,r])).entity=document.createElement("a-video"),i.video360=document.createElement("a-videosphere"),i.web2vr.aframe.scene.appendChild(i.video360),i.createClickEvent(),i.domElement.addEventListener("play",(function(){i.domElement.hasAttribute("vr")&&i.video360.components.material.material.map.image.play()})),i.domElement.addEventListener("pause",(function(){i.domElement.hasAttribute("vr")&&i.video360.components.material.material.map.image.pause()})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bt(t,e)}(e,t),n=e,(r=[{key:"createClickEvent",value:function(){var t=this;this.domElement.addEventListener("click",(function(){t.domElement.paused?t.domElement.play():t.domElement.pause()}))}},{key:"specificUpdate",value:function(){this.domElement.currentSrc;var t=this.domElement.id;if(t||(t=this.web2vr.aframe.assetManager.updateCurrentAssetIdReturn(),this.domElement.id=t),this.domElement.hasAttribute("vr")){this.video360.object3D.visible=!0,this.video360.classList.add(this.web2vr.settings.interactiveTag),this.entity.object3D.visible=!1,this.entity.classList.remove(this.web2vr.settings.interactiveTag),this.video360.setAttribute("src","#"+t);var e=this.domElement.getAttribute("vr");this.video360.object3D.rotation.y=e?THREE.MathUtils.degToRad(e):0}else this.video360.object3D.visible=!1,this.video360.classList.remove(this.web2vr.settings.interactiveTag),this.entity.object3D.visible=!0,this.entity.classList.add(this.web2vr.settings.interactiveTag),this.entity.setAttribute("src","#"+t)}}])&&dt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t,e){if("object"!=Et(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Et(e)?e:e+""}function St(t,e,n){return e=Tt(e),function(t,e){if(e&&("object"===Et(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,At()?Reflect.construct(e,n||[],Tt(t).constructor):e.apply(t,n))}function At(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(At=function(){return!!t})()}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tt(t)}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}var Pt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=St(this,e,[t,n,r])).borderColor=new THREE.Color(0),i.borderWidth=1,i.entity=document.createElement("a-plane"),i.domElement.addEventListener("click",function(){i.specificUpdate()}.bind(i)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(e,t),n=e,(r=[{key:"specificUpdate",value:function(){this.domElement.checked?this.entity.setAttribute("color","#0075FF"):this.entity.setAttribute("color","#FFFFFF")}}])&&gt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_t(r.key),r)}}function _t(t){var e=function(t,e){if("object"!=jt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jt(e)?e:e+""}function Ct(t,e,n){return e=Dt(e),function(t,e){if(e&&("object"===jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,kt()?Reflect.construct(e,n||[],Dt(t).constructor):e.apply(t,n))}function kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(kt=function(){return!!t})()}function Dt(t){return Dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dt(t)}function xt(t,e){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xt(t,e)}var Lt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Ct(this,e,[t,n,r])).borderColor=new THREE.Color(0),i.borderWidth=1,i.entity=document.createElement("a-circle"),i.domElement.addEventListener("click",function(){i.web2vr.update()}.bind(i)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xt(t,e)}(e,t),n=e,(r=[{key:"specificUpdate",value:function(){this.entity.setAttribute("radius",this.position.width/2),this.domElement.checked?this.entity.setAttribute("color","#0075FF"):this.entity.setAttribute("color","#FFFFFF")}}])&&Rt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ht(r.key),r)}}function Ht(t){var e=function(t,e){if("object"!=Nt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nt(e)?e:e+""}function Bt(t,e,n){return e=Gt(e),function(t,e){if(e&&("object"===Nt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Mt()?Reflect.construct(e,n||[],Gt(t).constructor):e.apply(t,n))}function Mt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Mt=function(){return!!t})()}function It(){return It="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},It.apply(this,arguments)}function Gt(t){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gt(t)}function Ft(t,e){return Ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ft(t,e)}var Ut=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Bt(this,e,[t,n,r])).borderColor=new THREE.Color(0),i.borderWidth=1,i.active=!1,i.domElement.addEventListener("input",(function(){return i.update()})),i.entity.addEventListener("click",(function(){var t=i.web2vr.aframe.scene.camera.parent,e=i.web2vr.aframe.keyboard.object3D,n=new THREE.Vector3;n.setFromMatrixPosition(t.matrixWorld),e.position.copy(n),e.rotation.copy(t.rotation),e.rotation.z=0,e.rotation.x=THREE.MathUtils.degToRad(-30),e.translateX(-.24),e.translateY(-.1),e.translateZ(-.6),e.visible=!0,i.web2vr.aframe.keyboard.activeInput&&(i.web2vr.aframe.keyboard.activeInput.element.active=!1,i.web2vr.aframe.keyboard.activeInput.element.web2vr.update()),i.active=!0,i.web2vr.aframe.keyboard.activeInput=i.domElement,i.web2vr.update()})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ft(t,e)}(e,t),n=e,(r=[{key:"updateText",value:function(){var t=this.domElement.value;this.textValue=t||this.domElement.placeholder}},{key:"updateTextColor",value:function(){this.domElement.value?It(Gt(e.prototype),"updateTextColor",this).call(this):this.entity.setAttribute("text","color","#999"),this.active&&this.entity.setAttribute("color","#ffffcc")}}])&&Vt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(nt);function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kt(r.key),r)}}function Kt(t){var e=function(t,e){if("object"!=zt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}function qt(t,e,n){return e=$t(e),function(t,e){if(e&&("object"===zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yt()?Reflect.construct(e,n||[],$t(t).constructor):e.apply(t,n))}function Yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yt=function(){return!!t})()}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}var Qt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=qt(this,e,[t,n,r])).borderColor=new THREE.Color(0),i.borderWidth=1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(e,t),n=e,(r=[{key:"updateTextPadding",value:function(){}},{key:"updateText",value:function(){"INPUT"==this.domElement.tagName&&(this.textValue=this.domElement.value.replace(/\s{2,}/g," "))}}])&&Wt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(nt);function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,te(r.key),r)}}function te(t){var e=function(t,e){if("object"!=Zt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zt(e)?e:e+""}function ee(t,e,n){return e=re(e),function(t,e){if(e&&("object"===Zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ne()?Reflect.construct(e,n||[],re(t).constructor):e.apply(t,n))}function ne(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ne=function(){return!!t})()}function re(t){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},re(t)}function ie(t,e){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ie(t,e)}var oe=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ee(this,e,[t,n,r])).imageId=null,i.entity=document.createElement("a-image"),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}(e,t),n=e,(r=[{key:"svgToImage",value:function(){var t=this,e=(new XMLSerializer).serializeToString(this.domElement),n=document.createElement("canvas"),r=n.getContext("2d");n.width=2*this.position.domPosition.width,n.height=2*this.position.domPosition.height;var i=self.URL||self.webkitURL||self,o=new Image,a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),s=i.createObjectURL(a);o.onload=function(){t.domElement.style.width?r.drawImage(o,0,0,2*n.width,2*n.height):r.drawImage(o,0,0,n.width,n.height),i.revokeObjectURL(s),t.updateImage(n.toDataURL()),n.remove()},o.src=s}},{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.imageId&&this.imageId!=e&&this.web2vr.aframe.assetManager.removeAsset(this.imageId),this.entity.setAttribute("id","IMAGE_"+e),this.entity.setAttribute("src","#"+e),this.imageId=e}},{key:"specificUpdate",value:function(){this.svgToImage()}}])&&Jt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,le(r.key),r)}}function le(t){var e=function(t,e){if("object"!=ae(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ae(e)?e:e+""}function ue(t,e,n){return e=he(e),function(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ce()?Reflect.construct(e,n||[],he(t).constructor):e.apply(t,n))}function ce(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ce=function(){return!!t})()}function he(t){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},he(t)}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}var fe=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ue(this,e,[t,n,r])).imageId=null,i.entity=document.createElement("a-image"),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(e,t),n=e,(r=[{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.imageId&&this.imageId!=e&&this.web2vr.aframe.assetManager.removeAsset(this.imageId),this.entity.setAttribute("id","IMAGE_"+e),this.entity.setAttribute("src","#"+e),this.imageId=e}},{key:"specificUpdate",value:function(){this.updateImage(this.domElement.toDataURL())}}])&&se(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(N);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function ve(){ve=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),s=new C(r||[]);return i(a,"_invoke",{value:P(t,n,s)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",v="completed",y={};function b(){}function m(){}function E(){}var g={};u(g,a,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(k([])));S&&S!==n&&r.call(S,a)&&(g=S);var A=E.prototype=b.prototype=Object.create(g);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,o,a,s){var l=h(t[i],t,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==pe(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(c).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function P(e,n,r){var i=d;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=j(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?v:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=v,r.method="throw",r.arg=u.arg)}}}function j(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(pe(e)+" is not iterable")}return m.prototype=E,i(A,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:m,configurable:!0}),m.displayName=u(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,u(t,l,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},T(O.prototype),u(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(A),u(A,l,"Generator"),u(A,a,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:k(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function ye(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function be(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ee(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function me(t){return function(t){if(Array.isArray(t))return ge(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ee(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(t,e){if(t){if("string"==typeof t)return ge(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Se(r.key),r)}}function Se(t){var e=function(t,e){if("object"!=pe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pe(e)?e:e+""}var Ae=function(){return t=function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n.nodeType==Node.ELEMENT_NODE?this.container=n:this.container=document.querySelector(n),this.settings=e()(new l,r,{arrayMerge:function(t,e){return[].concat(me(t),me(e))}}),this.aframe=new w(this.settings),this.elements=new Set,this.hoverSelectors=new Set,this.observer=null,this.observerConfig={childList:!0,subtree:!0,characterData:!0,attributes:!0},this.updating=!1,this.html2canvasIDcounter=0},n=[{key:"findHoverCss",value:function(){try{for(var t=0,e=me(document.styleSheets);t<e.length;t++)for(var n=e[t],r=0,i=me(n.cssRules);r<i.length;r++){var o=i[r];if(o instanceof CSSStyleRule){var a,s=be(o.selectorText.split(","));try{for(s.s();!(a=s.n()).done;){var l=a.value.split(":");if("hover"==l[1]){var u=l[0].replace(/\s/g,"");"."==u[0]?o.selectorText+=", ".concat(u,"hover"):"#"==u[0]?o.selectorText+=", .".concat(u.substr(1),"hover"):o.selectorText+=", .".concat(u,"hover"),this.hoverSelectors.add(u)}}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){console.error(t)}}},{key:"generateStyleDefs",value:function(t){for(var e="",n=document.styleSheets,r=0;r<n.length;r++)for(var i=n[r].cssRules,o=0;o<i.length;o++){var a=i[o];if(a.style){var s=a.selectorText;t.querySelectorAll(s).length&&(e+=s+" { "+a.style.cssText+" }\n")}}var l=document.createElement("style");l.setAttribute("type","text/css"),l.innerHTML=e;var u=document.createElement("defs");u.appendChild(l),t.insertBefore(u,t.firstChild)}},{key:"start",value:function(){var t=this;return new Promise((function(e,n){t.findHoverCss(),t.aframe.scene.hasLoaded?t.init().then((function(){e()})):t.aframe.scene.addEventListener("loaded",function(t,e,n){e.call(n),t()}(e,t.init,t),{once:!0})}))}},{key:"init",value:function(){var t=this;return this.aframe.createContainer(this),this.aframe.createSky(),this.aframe.createControllers(),this.convertToVR().then((function(){return t.scroll=new d(t),t.allLoadedUpdate()})).then((function(){return t.update()}))}},{key:"allLoadedUpdate",value:function(){var t=this;return new Promise((function(e,n){var r=setInterval((function(){var n,i=!0,o=be(t.elements);try{for(o.s();!(n=o.n()).done;){var a=n.value;a instanceof ct&&!a.loaded&&(i=!1)}}catch(t){o.e(t)}finally{o.f()}i&&(e(),clearInterval(r))}),100)}))}},{key:"addElement",value:function(t,e,n){var r=this;if(this.settings.ignoreTags.includes(t.tagName)||t.classList&&t.classList.contains("vr-span"))return null;var i=null;if(t.nodeType==Node.TEXT_NODE&&t.nodeValue.trim()){var o=document.createElement("span");o.classList.add("vr-span"),o.textContent=t.textContent,this.observer&&this.observer.disconnect(),t.replaceWith(o),this.observer&&(this.observer.observe(this.container,this.observerConfig),this.container.querySelectorAll("slot").forEach((function(t){r.observer.observe(t,r.observerConfig)}))),i=new nt(this,o,n)}else if("VIDEO"==t.tagName)i=new mt(this,t,n);else if("IMG"==t.tagName)i=new ct(this,t,n);else if("svg"==t.tagName)i=new oe(this,t,n);else if("CANVAS"==t.tagName)i=new fe(this,t,n);else if("BUTTON"==t.tagName)i=new Qt(this,t,n);else if("TEXTAREA"==t.tagName)i=new Ut(this,t,n);else if("INPUT"==t.tagName){var a=t.getAttribute("type");if("checkbox"==a)i=new Pt(this,t,n);else if("radio"==a)i=new Lt(this,t,n);else if(["text","email","number","password","search","tel","url"].includes(a))i=new Ut(this,t,n);else{if(!["button","submit","reset"].includes(a))return;i=new Qt(this,t,n)}}else if(t.shadowRoot)this.addElementChildren(t.shadowRoot,e,n);else{if(t.nodeType!=Node.ELEMENT_NODE)return;i=new q(this,t,n)}this.elements.add(i),this.aframe.container.appendChild(i.entity),this.settings.debug&&console.log("Added element",i);var s=function(){var t,n=(t=ve().mark((function t(n){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&e.childElements.add(i),i.init(),i.update();case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){ye(o,r,i,a,s,"next",t)}function s(t){ye(o,r,i,a,s,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}();return i.entity.addEventListener("play",s,{once:!0}),i}},{key:"removeElement",value:function(t){this.aframe.container.removeChild(t.entity),this.elements.delete(t);var e,n=be(t.childElements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.removeElement(r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"addElementChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(i,o){if("svg"==t.tagName&&e.generateStyleDefs(t),"SLOT"==t.tagName){var a,s=[],l=be(t.assignedNodes());try{for(l.s();!(a=l.n()).done;){var u=a.value;s.push(e.addElementChildren(u,n,r))}}catch(t){l.e(t)}finally{l.f()}Promise.all(s).then((function(){i()}))}var c=e.addElement(t,n,r);if(c&&!(c instanceof oe)&&t.childNodes&&t.childNodes.length>0){r++,s=[];var h,d=be(t.childNodes);try{for(d.s();!(h=d.n()).done;){var f=h.value;s.push(e.addElementChildren(f,c,r))}}catch(t){d.e(t)}finally{d.f()}Promise.all(s).then((function(){i()}))}}))}},{key:"convertToVR",value:function(){var t=this;return new Promise((function(e,n){t.addElementChildren(t.container).then((function(){t.observer=new MutationObserver((function(e){var n,r=be(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;console.log("Mutation encountered",i);var o,a=!1,s=be(i.removedNodes);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.nodeType!=Node.TEXT_NODE||l.nodeValue.trim()?t.removeElement(l.element):a=!0}}catch(t){s.e(t)}finally{s.f()}var u,c=be(i.addedNodes);try{for(c.s();!(u=c.n()).done;){var h=u.value;t.addElementChildren(h,i.target.element,i.target.element.layer+1)}}catch(t){c.e(t)}finally{c.f()}a||(i.addedNodes.length>0?t.allLoadedUpdate():t.update()),"characterData"==i.type&&t.update()}}catch(t){r.e(t)}finally{r.f()}})),t.observer.observe(t.container,t.observerConfig),t.container.querySelectorAll("slot").forEach((function(e){e.addEventListener("slotchange",(function(t){})),t.observer.observe(e,t.observerConfig)})),e()}))}))}},{key:"update",value:function(){var t=this;return new Promise((function(e,n){if(t.updating=!0,t.updating){var r;try{var i,o=be(t.elements);try{for(o.s();!(i=o.n()).done;)i.value.update()}catch(t){o.e(t)}finally{o.f()}}catch(t){console.error(t)}null===(r=t.scroll)||void 0===r||r.update(),t.updating=!1,e()}e()}))}}],n&&we(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}()})(),i.default})()));
//# sourceMappingURL=web2vr.min.js.map